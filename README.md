# ZAPPA_4156 Group Project: Trade Simulation

<h3>Overview</h3>

<p>This project is an API for creating competitive stock-trading games, in which the owners of virtual stock portfolios with an initial cash balance at the game's start can compete by buying and selling shares of stock at real market prices to achieve the highest portfolio value by the game's end. It uses stock price data from Yahoo Finance, which means players' knowledge of the real stock market will be a competitive advantage.<p>  
  
<h3>Packages needed for installation</h3>

This repository does not include third-party code other than the auto-generated skeleton code generated by django-admin startproject. Stock data is obtained from Yahoo Finance, using the yfinance python package. We are using AWS to host our postgresql database. This means a few packages need to be installed before use.<br/>

To install yfinance:<br/>
python -m pip install yfinance --upgrade --no-cache-dir<br/>

To install psycopg2:<br/>
python -m pip install psycopg2<br/>
  
To install Django:<br/>
python -m pip install Django<br/>

To install rest-framework:<br/>
python -m pip install djangorestframework<br/>

<h3>How to run the service</h3>

1. migrate <br/>
python .\zappa\manage.py migrate <br/>
python .\zappa\manage.py makemigrations <br/>
python .\zappa\manage.py migrate <br/>

2. run server <br/>
python .\zappa\manage.py runserver<br/>
  
<h3>Available endpoints for the service</h3>
  
Using the resource path http://127.0.0.1:8000/, the following methods are available:<br/>

<h4>Games</h4>
Each Game contains Portfolios that compete against each other to attain the highest value. A Game has a "title", "rules", a "starting_balance" that all portfolios within the game are initialized with, and a "winner" to be determined.<br/><br/>

<b>GET</b>   /api/games/ -- Returns the current status of all games and the portfolios within, including the values and rankings of portfolios within each game, using stock bid prices at the time called.<br/>
<b>GET</b>   /api/game/{game_title} -- Returns the current status of the game with title {game_title} and the portfolios within, including the values and rankings of its portfolios, using stock bid prices at the time called.<br/>
<b>POST</b>   /api/game/{game_title} -- Creates a new game with title {game_title}. Requires parameter "rules", and takes optional parameter "startingBalance" (default 10000.0). <br/>
<b>DELETE</b>   /api/game/{game_title} -- Deletes the game with title {game_title}. <br/>

<h4>Portfolios</h4>
Each Portfolio contains Holdings of stocks in various amounts. A Portfolio has a "title", a "cash_balance", a "total_value" computed from stock holdings plus cash balance, and a "game_rank" determined by how its total_value stacks up against other players.<br/><br/>

<b>GET</b>   /api/portfolios/ -- Returns the current status of all portfolios, including the current total_value of each, using stock bid prices at the time called.<br/>
<b>GET</b>   /api/portfolio/{game_title}/{port_title} -- Returns the current status of the portfolio from {game_title} with the title {port_title}, including its current total_value, using stock bid prices at the time called.<br/>
<b>POST</b>   /api/portfolio/{game_title}/{port_title} -- Creates a portfolio in game {game_title} with title {port_title}, with a starting cash_balance equal to the game's starting_balance.<br/> 
<b>DELETE</b>   /api/portfolio/{game_title}/{port_title} -- Deletes the portfolio from {game_title} with title {port_title}.<br/> 
<b>POST</b>   /api/portfolio/trade/ -- Performs a transaction on a portfolio. Requires parameters "portfolioTitle", "gameTitle", "ticker", and "shares". If the value of "shares" is positive, the portfolio in game "gameTitle" with title "portfolioTitle" will buy "shares" shares of the stock with ticker "ticker". If the value of "shares" is negative, that portfolio will sell "shares" shares of that stock instead.<br/>

<h4>Holdings</h4>
Each Holding represents shares of a stock held in a portfolio. A Holding has a "ticker" and a quantity "shares".<br/><br/>

<b>GET</b>   /api/holdings/ -- Returns all stock holdings in the database.<br/>
<b>GET</b>   /api/holding/{port_title}/{game_title}/{ticker} -- Returns the holding in the portfolio {port_title} within the game {game_title} corresponding to the ticker {ticker}.<br/>

<h4>Transactions</h4>
Each Transaction is a record of a transaction performed by a portfolio. A Transaction has a "ticker", a "trade_type" depending on what was performed, a quantity "shares", and a "bought_price" recording the price at the time of transaction.<br/><br/>

<b>GET</b>   /api/transactions/ -- Returns all transaction records in the database.<br/>
<b>GET</b>   /api/transaction/{uid} -- Returns the transaction record with uid {uid}.<br/>

<h3>Testing the service</h3>

Our testable code is contained within:
<ul>
  <li>zappa/api/helpers.py</li> 
  <li>zappa/api/serializers.py</li>
  <li>zappa/api/utils.py</li>
  <li>zappa/api/views.py</li>
  <li>zappa/trade_simulation/models.py</li>
</ul>


We have a suite of system tests using Postman, under the <a href="https://columbia-university-student-plan-team-187884.postman.co/workspace/ZAPPA~414bd806-3ab6-4b69-8800-28b2145f10ca/collection/14941238-038eb57b-2eae-4982-9dc1-a5c505356fce">ZAPPA workspace</a>.<br/>
To run our unit tests, (need to add content here).<br/>
We are using black and flake8 for Python style checking; the output file for this is (need to add content here).


